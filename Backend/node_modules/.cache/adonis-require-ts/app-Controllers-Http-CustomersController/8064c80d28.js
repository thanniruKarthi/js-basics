"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const CustomerDetail_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/CustomerDetail"));
const Database_1 = __importDefault(global[Symbol.for('ioc.use')]("Adonis/Lucid/Database"));
class CustomersController {
    async insertcustomer({ request }) {
        const table1 = new CustomerDetail_1.default();
        table1.cusid = request.input('id');
        table1.name = request.input('name');
        table1.owner = request.input('owner');
        await table1.save();
        return await CustomerDetail_1.default.all();
    }
    async readcustomer() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count')
            .orderBy('id', 'asc');
        return data;
    }
    async updatecustomer({ request }) {
        try {
            const user = await CustomerDetail_1.default.findByOrFail('id', request.params().id);
            user.cusid = request.input('id');
            user.name = request.input('name');
            user.owner = request.input('owner');
            await user.save();
            await user.save();
            return await CustomerDetail_1.default.all();
        }
        catch {
            return "sorry wrong details";
        }
    }
    async deletecustomer({ request }) {
        try {
            const user = await CustomerDetail_1.default.findByOrFail('id', request.params().id);
            user.delete();
            await user.save();
            return await CustomerDetail_1.default.all();
        }
        catch {
            return "sorry wrong details";
        }
    }
    async iddesc() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count')
            .orderBy('id', 'desc');
        return data;
    }
    async nameasc() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count')
            .orderBy('name', 'asc');
        return data;
    }
    async namedsc() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count')
            .orderBy('name', 'desc');
        return data;
    }
    async ownerasc() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count')
            .orderBy('owner', 'asc');
        return data;
    }
    async ownerdsc() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count')
            .orderBy('owner', 'desc');
        return data;
    }
    async searchcustomer({ request }) {
        const data = request.input('Key');
        return Database_1.default
            .from('customer_details')
            .select('*')
            .where((query) => {
            if (/^[0-9]/.test(data)) {
                query
                    .where('id', data)
                    .orWhere('cusid', data)
                    .orWhereILike('name', '%' + data + '%')
                    .orWhereILike('owner', '%' + data + '%');
            }
        })
            .orWhere((query) => {
            query
                .whereILike('name', '%' + data + '%')
                .orWhereILike('owner', '%' + data + '%');
        });
    }
    counting() {
        const data = Database_1.default.from('customer_details')
            .leftJoin('hotel_details', 'hotel_details.cusid', 'customer_details.cusid')
            .groupBy('customer_details.id')
            .select("customer_details.*")
            .count('customer_details.cusid as count');
        return data;
    }
}
exports.default = CustomersController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3VzdG9tZXJzQ29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkN1c3RvbWVyc0NvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSxxR0FBc0Q7QUFDdEQsMkZBQWlEO0FBQ2pELE1BQXFCLG1CQUFtQjtJQUU3QixLQUFLLENBQUMsY0FBYyxDQUFDLEVBQUMsT0FBTyxFQUFxQjtRQUUxRCxNQUFNLE1BQU0sR0FBQyxJQUFJLHdCQUFjLEVBQUUsQ0FBQTtRQUNqQyxNQUFNLENBQUMsS0FBSyxHQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDaEMsTUFBTSxDQUFDLElBQUksR0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBQ2pDLE1BQU0sQ0FBQyxLQUFLLEdBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUNuQyxNQUFNLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUNuQixPQUFPLE1BQU0sd0JBQWMsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtJQUNoQyxDQUFDO0lBQ00sS0FBSyxDQUFDLFlBQVk7UUFFdkIsTUFBTSxJQUFJLEdBQUMsa0JBQVEsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUM7YUFDM0MsUUFBUSxDQUFDLGVBQWUsRUFBQyxxQkFBcUIsRUFBQyx3QkFBd0IsQ0FBQzthQUN4RSxPQUFPLENBQUMscUJBQXFCLENBQUM7YUFDOUIsTUFBTSxDQUFDLG9CQUFvQixDQUFDO2FBQzVCLEtBQUssQ0FBQyxpQ0FBaUMsQ0FBQzthQUN4QyxPQUFPLENBQUMsSUFBSSxFQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ3BCLE9BQU8sSUFBSSxDQUFBO0lBRWIsQ0FBQztJQUNNLEtBQUssQ0FBQyxjQUFjLENBQUMsRUFBQyxPQUFPLEVBQUM7UUFFakMsSUFBRztZQUNMLE1BQU0sSUFBSSxHQUFDLE1BQU0sd0JBQWMsQ0FBQyxZQUFZLENB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QyxPQUFPLEVBQUMsR0FBRyxHQUFDLElBQUksR0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN2QyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDTyxRQUFRO1FBRWhCLE1BQU0sSUFBSSxHQUFDLGtCQUFRLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDO2FBQzNDLFFBQVEsQ0FBQyxlQUFlLEVBQUMscUJBQXFCLEVBQUMsd0JBQXdCLENBQUM7YUFDeEUsT0FBTyxDQUFDLHFCQUFxQixDQUFDO2FBQzlCLE1BQU0sQ0FBQyxvQkFBb0IsQ0FBQzthQUM1QixLQUFLLENBQUMsaUNBQWlDLENBQUMsQ0FBQTtRQUV6QyxPQUFPLElBQUksQ0FBQTtJQUNYLENBQUM7Q0FHVjtBQXZJRCxzQ0F1SUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEh0dHBDb250ZXh0Q29udHJhY3QgfSBmcm9tICdAaW9jOkFkb25pcy9Db3JlL0h0dHBDb250ZXh0J1xuaW1wb3J0IEN1c3RvbWVyRGV0YWlsIGZyb20gJ0FwcC9Nb2RlbHMvQ3VzdG9tZXJEZXRhaWwnXG5pbXBvcnQgRGF0YWJhc2UgZnJvbSAnQGlvYzpBZG9uaXMvTHVjaWQvRGF0YWJhc2UnXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdXN0b21lcnNDb250cm9sbGVyIHtcblxuICAgIHB1YmxpYyBhc3luYyBpbnNlcnRjdXN0b21lcih7cmVxdWVzdH06SHR0cENvbnRleHRDb250cmFjdClcbiAgICB7XG4gICBjb25zdCB0YWJsZTE9bmV3IEN1c3RvbWVyRGV0YWlsKClcbiAgIHRhYmxlMS5jdXNpZD1yZXF1ZXN0LmlucHV0KCdpZCcpXG4gICB0YWJsZTEubmFtZT1yZXF1ZXN0LmlucHV0KCduYW1lJylcbiAgIHRhYmxlMS5vd25lcj1yZXF1ZXN0LmlucHV0KCdvd25lcicpXG4gICBhd2FpdCB0YWJsZTEuc2F2ZSgpXG4gICByZXR1cm4gYXdhaXQgQ3VzdG9tZXJEZXRhaWwuYWxsKClcbiAgICB9XG4gICAgcHVibGljIGFzeW5jIHJlYWRjdXN0b21lcigpXG4gICAge1xuICAgICAgY29uc3QgZGF0YT1EYXRhYmFzZS5mcm9tKCdjdXN0b21lcl9kZXRhaWxzJylcbiAgICAgIC5sZWZ0Sm9pbignaG90ZWxfZGV0YWlscycsJ2hvdGVsX2RldGFpbHMuY3VzaWQnLCdjdXN0b21lcl9kZXRhaWxzLmN1c2lkJylcbiAgICAgIC5ncm91cEJ5KCdjdXN0b21lcl9kZXRhaWxzLmlkJylcbiAgICAgIC5zZWxlY3QoXCJjdXN0b21lcl9kZXRhaWxzLipcIilcbiAgICAgIC5jb3VudCgnY3VzdG9tZXJfZGV0YWlscy5jdXNpZCBhcyBjb3VudCcpXG4gICAgICAub3JkZXJCeSgnaWQnLCdhc2MnKVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICBcbiAgICB9XG4gICAgcHVibGljIGFzeW5jIHVwZGF0ZWN1c3RvbWVyKHtyZXF1ZXN0fSlcbiAgICB7XG4gICAgICAgIHRyeXtcbiAgICAgIGNvbnN0IHVzZXI9YXdhaXQgQ3VzdG9tZXJEZXRhaWwuZmluZEJ5T3JGYWlsKCdpZCcscmVxdWVzdC5wYXJhbXMoKS5pZClcbiAgICAgIHVzZXIuY3VzaWQ9cmVxdWVzdC5pbnB1dCgnaWQnKVxuICAgICAgdXNlci5uYW1lPXJlcXVlc3QuaW5wdXQoJ25hbWUnKVxuICAgICAgdXNlci5vd25lcj1yZXF1ZXN0LmlucHV0KCdvd25lcicpXG4gICAgICBhd2FpdCB1c2VyLnNhdmUoKVxuICAgIGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgcmV0dXJuIGF3YWl0IEN1c3RvbWVyRGV0YWlsLmFsbCgpXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2h7XG5cbiAgICAgICAgICByZXR1cm4gXCJzb3JyeSB3cm9uZyBkZXRhaWxzXCJcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgZGVsZXRlY3VzdG9tZXIoe3JlcXVlc3R9KVxuICAgIHtcbiAgICAgIHRyeXsgXG4gICAgICBcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IEN1c3RvbWVyRGV0YWlsLmZpbmRCeU9yRmFpbCgnaWQnLHJlcXVlc3QucGFyYW1zKCkuaWQpXG51c2VyLmRlbGV0ZSgpXG5hd2FpdCB1c2VyLnNhdmUoKVxucmV0dXJuIGF3YWl0IEN1c3RvbWVyRGV0YWlsLmFsbCgpXG4gICAgICB9XG4gICAgICBjYXRjaHtcbiAgICAgICAgcmV0dXJuIFwic29ycnkgd3JvbmcgZGV0YWlsc1wiXG4gICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBhc3luYyBpZGRlc2MoKVxuICAgIHtcbiAgICAgIGNvbnN0IGRhdGE9RGF0YWJhc2UuZnJvbSgnY3VzdG9tZXJfZGV0YWlscycpXG4gICAgICAubGVmdEpvaW4oJ2hvdGVsX2RldGFpbHMnLCdob3RlbF9kZXRhaWxzLmN1c2lkJywnY3VzdG9tZXJfZGV0YWlscy5jdXNpZCcpXG4gICAgICAuZ3JvdXBCeSgnY3VzdG9tZXJfZGV0YWlscy5pZCcpXG4gICAgICAuc2VsZWN0KFwiY3VzdG9tZXJfZGV0YWlscy4qXCIpXG4gICAgICAuY291bnQoJ2N1c3RvbWVyX2RldGFpbHMuY3VzaWQgYXMgY291bnQnKVxuICAgICAgLm9yZGVyQnkoJ2lkJywnZGVzYycpXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgbmFtZWFzYygpXG4gICAge1xuICAgICAgY29uc3QgZGF0YT1EYXRhYmFzZS5mcm9tKCdjdXN0b21lcl9kZXRhaWxzJylcbiAgICAgIC5sZWZ0Sm9pbignaG90ZWxfZGV0YWlscycsJ2hvdGVsX2RldGFpbHMuY3VzaWQnLCdjdXN0b21lcl9kZXRhaWxzLmN1c2lkJylcbiAgICAgIC5ncm91cEJ5KCdjdXN0b21lcl9kZXRhaWxzLmlkJylcbiAgICAgIC5zZWxlY3QoXCJjdXN0b21lcl9kZXRhaWxzLipcIilcbiAgICAgIC5jb3VudCgnY3VzdG9tZXJfZGV0YWlscy5jdXNpZCBhcyBjb3VudCcpXG4gICAgICAub3JkZXJCeSgnbmFtZScsJ2FzYycpXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgbmFtZWRzYygpXG4gICAge1xuICAgICAgY29uc3QgZGF0YT1EYXRhYmFzZS5mcm9tKCdjdXN0b21lcl9kZXRhaWxzJylcbiAgICAgIC5sZWZ0Sm9pbignaG90ZWxfZGV0YWlscycsJ2hvdGVsX2RldGFpbHMuY3VzaWQnLCdjdXN0b21lcl9kZXRhaWxzLmN1c2lkJylcbiAgICAgIC5ncm91cEJ5KCdjdXN0b21lcl9kZXRhaWxzLmlkJylcbiAgICAgIC5zZWxlY3QoXCJjdXN0b21lcl9kZXRhaWxzLipcIilcbiAgICAgIC5jb3VudCgnY3VzdG9tZXJfZGV0YWlscy5jdXNpZCBhcyBjb3VudCcpXG4gICAgICAub3JkZXJCeSgnbmFtZScsJ2Rlc2MnKVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9XG4gICAgcHVibGljIGFzeW5jIG93bmVyYXNjKClcbiAgICB7XG4gICAgICBjb25zdCBkYXRhPURhdGFiYXNlLmZyb20oJ2N1c3RvbWVyX2RldGFpbHMnKVxuICAgICAgLmxlZnRKb2luKCdob3RlbF9kZXRhaWxzJywnaG90ZWxfZGV0YWlscy5jdXNpZCcsJ2N1c3RvbWVyX2RldGFpbHMuY3VzaWQnKVxuICAgICAgLmdyb3VwQnkoJ2N1c3RvbWVyX2RldGFpbHMuaWQnKVxuICAgICAgLnNlbGVjdChcImN1c3RvbWVyX2RldGFpbHMuKlwiKVxuICAgICAgLmNvdW50KCdjdXN0b21lcl9kZXRhaWxzLmN1c2lkIGFzIGNvdW50JylcbiAgICAgIC5vcmRlckJ5KCdvd25lcicsJ2FzYycpXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgb3duZXJkc2MoKVxuICAgIHtcbiAgICAgIGNvbnN0IGRhdGE9RGF0YWJhc2UuZnJvbSgnY3VzdG9tZXJfZGV0YWlscycpXG4gICAgICAubGVmdEpvaW4oJ2hvdGVsX2RldGFpbHMnLCdob3RlbF9kZXRhaWxzLmN1c2lkJywnY3VzdG9tZXJfZGV0YWlscy5jdXNpZCcpXG4gICAgICAuZ3JvdXBCeSgnY3VzdG9tZXJfZGV0YWlscy5pZCcpXG4gICAgICAuc2VsZWN0KFwiY3VzdG9tZXJfZGV0YWlscy4qXCIpXG4gICAgICAuY291bnQoJ2N1c3RvbWVyX2RldGFpbHMuY3VzaWQgYXMgY291bnQnKVxuICAgICAgLm9yZGVyQnkoJ293bmVyJywnZGVzYycpXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgYXN5bmMgc2VhcmNoY3VzdG9tZXIoe3JlcXVlc3R9KVxue1xuY29uc3QgZGF0YSA9IHJlcXVlc3QuaW5wdXQoJ0tleScpXG4gICAgICAgICAgICByZXR1cm4gRGF0YWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdjdXN0b21lcl9kZXRhaWxzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAgICAgLndoZXJlKChxdWVyeSkgPT57XG4gICAgICAgICAgICAgICAgaWYoL15bMC05XS8udGVzdChkYXRhKSl7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5XG4gICAgICAgICAgICAgICAgICAgIC53aGVyZSgnaWQnLGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC5vcldoZXJlKCdjdXNpZCcsZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLm9yV2hlcmVJTGlrZSgnbmFtZScsJyUnK2RhdGErJyUnKVxuICAgICAgICAgICAgICAgICAgICAub3JXaGVyZUlMaWtlKCdvd25lcicsJyUnK2RhdGErJyUnKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub3JXaGVyZSgocXVlcnkpID0+e1xuICAgICAgICAgICAgICAgIHF1ZXJ5XG4gICAgICAgICAgICAgICAgLndoZXJlSUxpa2UoJ25hbWUnLCclJytkYXRhKyclJylcbiAgICAgICAgICAgICAgICAub3JXaGVyZUlMaWtlKCdvd25lcicsJyUnK2RhdGErJyUnKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgICAgcHVibGljICBjb3VudGluZygpXG4gICAgICAgICAge1xuICAgICAgICAgIGNvbnN0IGRhdGE9RGF0YWJhc2UuZnJvbSgnY3VzdG9tZXJfZGV0YWlscycpXG4gICAgICAgICAgLmxlZnRKb2luKCdob3RlbF9kZXRhaWxzJywnaG90ZWxfZGV0YWlscy5jdXNpZCcsJ2N1c3RvbWVyX2RldGFpbHMuY3VzaWQnKVxuICAgICAgICAgIC5ncm91cEJ5KCdjdXN0b21lcl9kZXRhaWxzLmlkJylcbiAgICAgICAgICAuc2VsZWN0KFwiY3VzdG9tZXJfZGV0YWlscy4qXCIpXG4gICAgICAgICAgLmNvdW50KCdjdXN0b21lcl9kZXRhaWxzLmN1c2lkIGFzIGNvdW50JylcblxuICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgfVxuXG5cbn1cbiJdfQ==